!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){t.fn.jScrollPane=function(e){function n(e,n){function o(n){var s,a,l,p,u,h,j=!1,g=!1;if(F=n,void 0===L)u=e.scrollTop(),h=e.scrollLeft(),e.css({overflow:"hidden",padding:0}),q=e.innerWidth()+vt,O=e.innerHeight(),e.width(q),L=t('<div class="jspPane" />').css("padding",gt).append(e.children()),V=t('<div class="jspContainer" />').css({width:q+"px",height:O+"px"}).append(L).appendTo(e);else{if(e.css("width",""),j=F.stickToBottom&&D(),g=F.stickToRight&&x(),p=e.innerWidth()+vt!=q||e.outerHeight()!=O,p&&(q=e.innerWidth()+vt,O=e.innerHeight(),V.css({width:q+"px",height:O+"px"})),!p&&mt==G&&L.outerHeight()==N)return void e.width(q);mt=G,L.css("width",""),e.width(q),V.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}L.css("overflow","auto"),G=n.contentWidth?n.contentWidth:L[0].scrollWidth,N=L[0].scrollHeight,L.css("overflow",""),E=G/q,K=N/O,Q=K>1,U=E>1,U||Q?(e.addClass("jspScrollable"),s=F.maintainPosition&&(Z||et),s&&(a=T(),l=B()),i(),r(),c(),s&&(y(g?G-q:a,!1),k(j?N-O:l,!1)),A(),H(),R(),F.enableKeyboardNavigation&&Y(),F.clickOnTrack&&d(),M(),F.hijackInternalLinks&&X()):(e.removeClass("jspScrollable"),L.css({top:0,left:0,width:V.width()-vt}),S(),W(),z(),f()),F.autoReinitialise&&!jt?jt=setInterval(function(){o(F)},F.autoReinitialiseDelay):!F.autoReinitialise&&jt&&clearInterval(jt),u&&e.scrollTop(0)&&k(u,!1),h&&e.scrollLeft(0)&&y(h,!1),e.trigger("jsp-initialised",[U||Q])}function i(){Q&&(V.append(t('<div class="jspVerticalBar" />').append(t('<div class="jspCap jspCapTop" />'),t('<div class="jspTrack" />').append(t('<div class="jspDrag" />').append(t('<div class="jspDragTop" />'),t('<div class="jspDragBottom" />'))),t('<div class="jspCap jspCapBottom" />'))),nt=V.find(">.jspVerticalBar"),ot=nt.find(">.jspTrack"),$=ot.find(">.jspDrag"),F.showArrows&&(at=t('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",p(0,-1)).bind("click.jsp",P),ct=t('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",p(0,1)).bind("click.jsp",P),F.arrowScrollOnHover&&(at.bind("mouseover.jsp",p(0,-1,at)),ct.bind("mouseover.jsp",p(0,1,ct))),l(ot,F.verticalArrowPositions,at,ct)),st=O,V.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){st-=t(this).outerHeight()}),$.hover(function(){$.addClass("jspHover")},function(){$.removeClass("jspHover")}).bind("mousedown.jsp",function(e){t("html").bind("dragstart.jsp selectstart.jsp",P),$.addClass("jspActive");var n=e.pageY-$.position().top;return t("html").bind("mousemove.jsp",function(t){j(t.pageY-n,!1)}).bind("mouseup.jsp mouseleave.jsp",h),!1}),s())}function s(){ot.height(st+"px"),Z=0,it=F.verticalGutter+ot.outerWidth(),L.width(q-it-vt);try{0===nt.position().left&&L.css("margin-left",it+"px")}catch(t){}}function r(){U&&(V.append(t('<div class="jspHorizontalBar" />').append(t('<div class="jspCap jspCapLeft" />'),t('<div class="jspTrack" />').append(t('<div class="jspDrag" />').append(t('<div class="jspDragLeft" />'),t('<div class="jspDragRight" />'))),t('<div class="jspCap jspCapRight" />'))),lt=V.find(">.jspHorizontalBar"),pt=lt.find(">.jspTrack"),_=pt.find(">.jspDrag"),F.showArrows&&(ft=t('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",p(-1,0)).bind("click.jsp",P),ht=t('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",p(1,0)).bind("click.jsp",P),F.arrowScrollOnHover&&(ft.bind("mouseover.jsp",p(-1,0,ft)),ht.bind("mouseover.jsp",p(1,0,ht))),l(pt,F.horizontalArrowPositions,ft,ht)),_.hover(function(){_.addClass("jspHover")},function(){_.removeClass("jspHover")}).bind("mousedown.jsp",function(e){t("html").bind("dragstart.jsp selectstart.jsp",P),_.addClass("jspActive");var n=e.pageX-_.position().left;return t("html").bind("mousemove.jsp",function(t){v(t.pageX-n,!1)}).bind("mouseup.jsp mouseleave.jsp",h),!1}),ut=V.innerWidth(),a())}function a(){V.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){ut-=t(this).outerWidth()}),pt.width(ut+"px"),et=0}function c(){if(U&&Q){var e=pt.outerHeight(),n=ot.outerWidth();st-=e,t(lt).find(">.jspCap:visible,>.jspArrow").each(function(){ut+=t(this).outerWidth()}),ut-=n,O-=n,q-=e,pt.parent().append(t('<div class="jspCorner" />').css("width",e+"px")),s(),a()}U&&L.width(V.outerWidth()-vt+"px"),N=L.outerHeight(),K=N/O,U&&(dt=Math.ceil(1/E*ut),dt>F.horizontalDragMaxWidth?dt=F.horizontalDragMaxWidth:dt<F.horizontalDragMinWidth&&(dt=F.horizontalDragMinWidth),_.width(dt+"px"),tt=ut-dt,m(et)),Q&&(rt=Math.ceil(1/K*st),rt>F.verticalDragMaxHeight?rt=F.verticalDragMaxHeight:rt<F.verticalDragMinHeight&&(rt=F.verticalDragMinHeight),$.height(rt+"px"),J=st-rt,g(Z))}function l(t,e,n,o){var i,s="before",r="after";"os"==e&&(e=/Mac/.test(navigator.platform)?"after":"split"),e==s?r=e:e==r&&(s=e,i=n,n=o,o=i),t[s](n)[r](o)}function p(t,e,n){return function(){return u(t,e,this,n),this.blur(),!1}}function u(e,n,o,i){o=t(o).addClass("jspActive");var s,r,a=!0,c=function(){0!==e&&bt.scrollByX(e*F.arrowButtonSpeed),0!==n&&bt.scrollByY(n*F.arrowButtonSpeed),r=setTimeout(c,a?F.initialDelay:F.arrowRepeatFreq),a=!1};c(),s=i?"mouseout.jsp":"mouseup.jsp",i=i||t("html"),i.bind(s,function(){o.removeClass("jspActive"),r&&clearTimeout(r),r=null,i.unbind(s)})}function d(){f(),Q&&ot.bind("mousedown.jsp",function(e){if(void 0===e.originalTarget||e.originalTarget==e.currentTarget){var n,o=t(this),i=o.offset(),s=e.pageY-i.top-Z,r=!0,a=function(){var t=o.offset(),i=e.pageY-t.top-rt/2,l=O*F.scrollPagePercent,p=J*l/(N-O);if(0>s)Z-p>i?bt.scrollByY(-l):j(i);else{if(!(s>0))return void c();i>Z+p?bt.scrollByY(l):j(i)}n=setTimeout(a,r?F.initialDelay:F.trackClickRepeatFreq),r=!1},c=function(){n&&clearTimeout(n),n=null,t(document).unbind("mouseup.jsp",c)};return a(),t(document).bind("mouseup.jsp",c),!1}}),U&&pt.bind("mousedown.jsp",function(e){if(void 0===e.originalTarget||e.originalTarget==e.currentTarget){var n,o=t(this),i=o.offset(),s=e.pageX-i.left-et,r=!0,a=function(){var t=o.offset(),i=e.pageX-t.left-dt/2,l=q*F.scrollPagePercent,p=tt*l/(G-q);if(0>s)et-p>i?bt.scrollByX(-l):v(i);else{if(!(s>0))return void c();i>et+p?bt.scrollByX(l):v(i)}n=setTimeout(a,r?F.initialDelay:F.trackClickRepeatFreq),r=!1},c=function(){n&&clearTimeout(n),n=null,t(document).unbind("mouseup.jsp",c)};return a(),t(document).bind("mouseup.jsp",c),!1}})}function f(){pt&&pt.unbind("mousedown.jsp"),ot&&ot.unbind("mousedown.jsp")}function h(){t("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),$&&$.removeClass("jspActive"),_&&_.removeClass("jspActive")}function j(t,e){Q&&(0>t?t=0:t>J&&(t=J),void 0===e&&(e=F.animateScroll),e?bt.animate($,"top",t,g):($.css("top",t),g(t)))}function g(t){void 0===t&&(t=$.position().top),V.scrollTop(0),Z=t||0;var n=0===Z,o=Z==J,i=t/J,s=-i*(N-O);(wt!=n||yt!=o)&&(wt=n,yt=o,e.trigger("jsp-arrow-change",[wt,yt,kt,Ct])),b(n,o),L.css("top",s),e.trigger("jsp-scroll-y",[-s,n,o]).trigger("scroll")}function v(t,e){U&&(0>t?t=0:t>tt&&(t=tt),void 0===e&&(e=F.animateScroll),e?bt.animate(_,"left",t,m):(_.css("left",t),m(t)))}function m(t){void 0===t&&(t=_.position().left),V.scrollTop(0),et=t||0;var n=0===et,o=et==tt,i=t/tt,s=-i*(G-q);(kt!=n||Ct!=o)&&(kt=n,Ct=o,e.trigger("jsp-arrow-change",[wt,yt,kt,Ct])),w(n,o),L.css("left",s),e.trigger("jsp-scroll-x",[-s,n,o]).trigger("scroll")}function b(t,e){F.showArrows&&(at[t?"addClass":"removeClass"]("jspDisabled"),ct[e?"addClass":"removeClass"]("jspDisabled"))}function w(t,e){F.showArrows&&(ft[t?"addClass":"removeClass"]("jspDisabled"),ht[e?"addClass":"removeClass"]("jspDisabled"))}function k(t,e){var n=t/(N-O);j(n*J,e)}function y(t,e){var n=t/(G-q);v(n*tt,e)}function C(e,n,o){var i,s,r,a,c,l,p,u,d,f=0,h=0;try{i=t(e)}catch(j){return}for(s=i.outerHeight(),r=i.outerWidth(),V.scrollTop(0),V.scrollLeft(0);!i.is(".jspPane");)if(f+=i.position().top,h+=i.position().left,i=i.offsetParent(),/^body|html$/i.test(i[0].nodeName))return;a=B(),l=a+O,a>f||n?u=f-F.horizontalGutter:f+s>l&&(u=f-O+s+F.horizontalGutter),isNaN(u)||k(u,o),c=T(),p=c+q,c>h||n?d=h-F.horizontalGutter:h+r>p&&(d=h-q+r+F.horizontalGutter),isNaN(d)||y(d,o)}function T(){return-L.position().left}function B(){return-L.position().top}function D(){var t=N-O;return t>20&&t-B()<10}function x(){var t=G-q;return t>20&&t-T()<10}function H(){V.unbind(Bt).bind(Bt,function(t,e,n,o){et||(et=0),Z||(Z=0);var i=et,s=Z,r=t.deltaFactor||F.mouseWheelSpeed;return bt.scrollBy(n*r,-o*r,!1),i==et&&s==Z})}function S(){V.unbind(Bt)}function P(){return!1}function A(){L.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(t){C(t.target,!1)})}function W(){L.find(":input,a").unbind("focus.jsp")}function Y(){function n(){var t=et,e=Z;switch(o){case 40:bt.scrollByY(F.keyboardSpeed,!1);break;case 38:bt.scrollByY(-F.keyboardSpeed,!1);break;case 34:case 32:bt.scrollByY(O*F.scrollPagePercent,!1);break;case 33:bt.scrollByY(-O*F.scrollPagePercent,!1);break;case 39:bt.scrollByX(F.keyboardSpeed,!1);break;case 37:bt.scrollByX(-F.keyboardSpeed,!1)}return i=t!=et||e!=Z}var o,i,s=[];U&&s.push(lt[0]),Q&&s.push(nt[0]),L.bind("focus.jsp",function(){e.focus()}),e.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(e){if(e.target===this||s.length&&t(e.target).closest(s).length){var r=et,a=Z;switch(e.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:o=e.keyCode,n();break;case 35:k(N-O),o=null;break;case 36:k(0),o=null}return i=e.keyCode==o&&r!=et||a!=Z,!i}}).bind("keypress.jsp",function(e){return e.keyCode==o&&n(),e.target===this||s.length&&t(e.target).closest(s).length?!i:void 0}),F.hideFocus?(e.css("outline","none"),"hideFocus"in V[0]&&e.attr("hideFocus",!0)):(e.css("outline",""),"hideFocus"in V[0]&&e.attr("hideFocus",!1))}function z(){e.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp"),L.unbind(".jsp")}function M(){if(location.hash&&location.hash.length>1){var e,n,o=escape(location.hash.substr(1));try{e=t("#"+o+', a[name="'+o+'"]')}catch(i){return}e.length&&L.find(o)&&(0===V.scrollTop()?n=setInterval(function(){V.scrollTop()>0&&(C(e,!0),t(document).scrollTop(V.position().top),clearInterval(n))},50):(C(e,!0),t(document).scrollTop(V.position().top)))}}function X(){t(document.body).data("jspHijack")||(t(document.body).data("jspHijack",!0),t(document.body).delegate("a[href*=#]","click",function(e){var n,o,i,s,r,a,c=this.href.substr(0,this.href.indexOf("#")),l=location.href;if(-1!==location.href.indexOf("#")&&(l=location.href.substr(0,location.href.indexOf("#"))),c===l){n=escape(this.href.substr(this.href.indexOf("#")+1));try{o=t("#"+n+', a[name="'+n+'"]')}catch(p){return}o.length&&(i=o.closest(".jspScrollable"),s=i.data("jsp"),s.scrollToElement(o,!0),i[0].scrollIntoView&&(r=t(window).scrollTop(),a=o.offset().top,(r>a||a>r+t(window).height())&&i[0].scrollIntoView()),e.preventDefault())}}))}function R(){var t,e,n,o,i,s=!1;V.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(r){var a=r.originalEvent.touches[0];t=T(),e=B(),n=a.pageX,o=a.pageY,i=!1,s=!0}).bind("touchmove.jsp",function(r){if(s){var a=r.originalEvent.touches[0],c=et,l=Z;return bt.scrollTo(t+n-a.pageX,e+o-a.pageY),i=i||Math.abs(n-a.pageX)>5||Math.abs(o-a.pageY)>5,c==et&&l==Z}}).bind("touchend.jsp",function(t){s=!1}).bind("click.jsp-touchclick",function(t){return i?(i=!1,!1):void 0})}function I(){var t=B(),n=T();e.removeClass("jspScrollable").unbind(".jsp"),L.unbind(".jsp"),e.replaceWith(Tt.append(L.children())),Tt.scrollTop(t),Tt.scrollLeft(n),jt&&clearInterval(jt)}var F,L,q,O,V,G,N,E,K,Q,U,$,J,Z,_,tt,et,nt,ot,it,st,rt,at,ct,lt,pt,ut,dt,ft,ht,jt,gt,vt,mt,bt=this,wt=!0,kt=!0,yt=!1,Ct=!1,Tt=e.clone(!1,!1).empty(),Bt=t.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";"border-box"===e.css("box-sizing")?(gt=0,vt=0):(gt=e.css("paddingTop")+" "+e.css("paddingRight")+" "+e.css("paddingBottom")+" "+e.css("paddingLeft"),vt=(parseInt(e.css("paddingLeft"),10)||0)+(parseInt(e.css("paddingRight"),10)||0)),t.extend(bt,{reinitialise:function(e){e=t.extend({},F,e),o(e)},scrollToElement:function(t,e,n){C(t,e,n)},scrollTo:function(t,e,n){y(t,n),k(e,n)},scrollToX:function(t,e){y(t,e)},scrollToY:function(t,e){k(t,e)},scrollToPercentX:function(t,e){y(t*(G-q),e)},scrollToPercentY:function(t,e){k(t*(N-O),e)},scrollBy:function(t,e,n){bt.scrollByX(t,n),bt.scrollByY(e,n)},scrollByX:function(t,e){var n=T()+Math[0>t?"floor":"ceil"](t),o=n/(G-q);v(o*tt,e)},scrollByY:function(t,e){var n=B()+Math[0>t?"floor":"ceil"](t),o=n/(N-O);j(o*J,e)},positionDragX:function(t,e){v(t,e)},positionDragY:function(t,e){j(t,e)},animate:function(t,e,n,o){var i={};i[e]=n,t.animate(i,{duration:F.animateDuration,easing:F.animateEase,queue:!1,step:o})},getContentPositionX:function(){return T()},getContentPositionY:function(){return B()},getContentWidth:function(){return G},getContentHeight:function(){return N},getPercentScrolledX:function(){return T()/(G-q)},getPercentScrolledY:function(){return B()/(N-O)},getIsScrollableH:function(){return U},getIsScrollableV:function(){return Q},getContentPane:function(){return L},scrollToBottom:function(t){j(J,t)},hijackInternalLinks:t.noop,destroy:function(){I()}}),o(n)}return e=t.extend({},t.fn.jScrollPane.defaults,e),t.each(["arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){e[this]=e[this]||e.speed}),this.each(function(){var o=t(this),i=o.data("jsp");i?i.reinitialise(e):(t("script",o).filter('[type="text/javascript"],:not([type])').remove(),i=new n(o,e),o.data("jsp",i))})},t.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:void 0,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:3,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}});